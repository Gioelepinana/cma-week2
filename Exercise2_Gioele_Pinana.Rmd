---
title: "PTED / Exercise 2"
author: "Gioele Pinana"
date: '2022-04-29'
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Task 1: Import your Data
Load the necessary libraries
```{r}
library(readr)        # to import tabular data (e.g. csv)
library(dplyr)        # to manipulate (tabular) data
library(ggplot2)      # to visualize data
library(sf)           # to handle spatial vector data
library(terra)        # To handle raster data
library(lubridate)    # To handle dates and times

```
Import the downloaded csv
```{r}
wildschwein_BE <- read_delim("wildschwein_BE_2056.csv",",") # adjust path

wildschwein_BE <- st_as_sf(wildschwein_BE, coords = c("E", "N"), crs = 2056, remove = FALSE)
```

## Task 2: Getting an Overview
difference between subsequent rows, aggiungere descrizione 
```{r}
wildschwein_BE$timelag  <- as.integer(difftime(lead(wildschwein_BE$DatetimeUTC), wildschwein_BE$DatetimeUTC, units = c("secs")))
wildschwein_BE
```

- How many individuals were tracked?
the function count () lets you count the unic value of a variable
```{r}
wildschwein_BE %>% count(TierName)
```
3 individuals were tracked: Rosa, Ruth and Sabi

- For how long were the individual tracked? Are there gaps?
```{r}
summary(wildschwein_BE$DatetimeUTC)
summary(wildschwein_BE$timelag)
```
From 22. August 2014 until 27. Juli 2015. There is one missing values but also some outliers.

- Were all individuals tracked concurrently or sequentially?
```{r}
ggplot(wildschwein_BE, aes(DatetimeUTC, TierName))+
  geom_line()
```
Sabi from 08.2014 until 07.2015, Rosa from 11.2014 until 06.2015 and Ruth from 11.2014 until 07.2015.

- What is the temporal sampling interval between the locations?
About 15 minutes. 

## Task 3: Deriving movement parameters I: Speed
```{r}
n=dim(wildschwein_BE)[1]
n=51247
E1=wildschwein_BE$E[1:(n-1)]
E2=wildschwein_BE$E[2:n]
N1=wildschwein_BE$N[1:(n-1)]
N2=wildschwein_BE$N[2:n]
dist=sqrt((E1-E2)^2+(N1-N2)^2)

wildschwein_BE$steplenght <- dist

wildschwein_BE$speed <- dist/wildschwein_BE$timelag
```

## Task 4: Cross-scale movement analysis 

```{r}
caro <- read_delim("caro60.csv",",") 
caro <- st_as_sf(caro, coords = c("E", "N"), remove = FALSE)
```

```{r}
# 3
caro_3 <- caro %>%
  slice(seq(from = 1, to = 200, by = 3)) 

caro_3$timelag  <- as.integer(difftime(lead(caro_3$DatetimeUTC), caro_3$DatetimeUTC, units = c("secs")))

n=68
E1=caro_3$E[1:(n-1)]
E2=caro_3$E[2:n]
N2=caro_3$N[2:n]
N1=caro_3$N[1:(n-1)]
dist=sqrt((E1-E2)^2+(N1-N2)^2)

caro_3$steplenght <- dist

caro_3$speed <- dist/caro_3$timelag

# 6
caro_6 <- caro %>%
  slice(seq(from = 1, to = 200, by = 6))

caro_6$timelag  <- as.integer(difftime(lead(caro_6$DatetimeUTC), caro_6$DatetimeUTC, units = c("secs")))

n=35
E1=caro_6$E[1:(n-1)]
E2=caro_6$E[2:n]
N2=caro_6$N[2:n]
N1=caro_6$N[1:(n-1)]
dist=sqrt((E1-E2)^2+(N1-N2)^2)

caro_6$steplenght <- dist

caro_6$speed <- dist/caro_6$timelag

# 9
caro_9 <- caro %>%
  slice(seq(from = 1, to = 200, by = 9))

caro_9$timelag  <- as.integer(difftime(lead(caro_9$DatetimeUTC), caro_9$DatetimeUTC, units = c("secs")))

n=24
E1=caro_9$E[1:(n-1)]
E2=caro_9$E[2:n]
N2=caro_9$N[2:n]
N1=caro_9$N[1:(n-1)]
dist=sqrt((E1-E2)^2+(N1-N2)^2)

caro_9$steplenght <- dist

caro_9$speed <- dist/caro_9$timelag
```














